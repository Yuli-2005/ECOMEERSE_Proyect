<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Detalle del Producto | Fashion & Style</title>

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- CSS Global -->
  <link rel="stylesheet" href="css/style.css">
</head>

<!-- CLASE ESPECÍFICA PARA APLICAR CSS SOLO A ESTE MÓDULO -->
<body class="producto-page">

<!-- ===========================================================
     HEADER
=========================================================== -->
<section id="header" class="py-3 shadow-sm sticky-top">
  <div class="container d-flex justify-content-between align-items-center flex-wrap">

    <!-- Logo -->
    <a href="index.html">
      <img src="img/logo.png" alt="Logo" class="logo">
    </a>

    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-light p-0">
      <button class="navbar-toggler border-0 bg-transparent" type="button"
              data-bs-toggle="collapse" data-bs-target="#navbarMenu">
        <i class="fa-solid fa-bars fs-3"></i>
      </button>

      <div class="collapse navbar-collapse justify-content-end" id="navbarMenu">
        <ul id="navbar" class="navbar-nav align-items-lg-center">

          <li class="nav-item"><a href="index.html" class="nav-link">Inicio</a></li>
          <li class="nav-item"><a href="tienda.html" class="nav-link">Tienda</a></li>
          <li class="nav-item"><a href="sobrenosotros.html" class="nav-link">Sobre nosotros</a></li>
          <li class="nav-item"><a href="contactanos.html" class="nav-link">Contáctanos</a></li>

          <!-- Buscador -->
          <li class="nav-item ms-lg-3">
            <a href="#" class="nav-link" id="open-search">
              <i class="fa-solid fa-magnifying-glass"></i>
            </a>
          </li>

          <!-- Carrito -->
          <li class="nav-item ms-lg-3">
            <a href="carrito.html" class="nav-link">
              <i class="fa-solid fa-cart-shopping"></i>
              <span id="cart-count" class="badge bg-danger ms-1">0</span>
            </a>
          </li>

        </ul>
      </div>
    </nav>
  </div>
</section>

<!-- ===========================================================
     PANEL DE BÚSQUEDA
=========================================================== -->
<div id="search-panel" class="search-panel">
  <div class="container d-flex align-items-center py-3">
    <i class="fa-solid fa-magnifying-glass me-3"></i>
    <input type="text" id="search-input" class="form-control border-0 shadow-0" placeholder="Buscar...">
    <button id="close-search" class="btn btn-link fs-4 text-dark"><i class="fa-solid fa-xmark"></i></button>
  </div>
</div>

<!-- ===========================================================
     DETALLE DEL PRODUCTO
=========================================================== -->
<section id="detalle-producto" class="container py-5 section-p1">
  <div class="row align-items-center">

    <!-- Imagen principal -->
    <div class="col-md-6 text-center">
      <img id="producto-imagen" src="img/products/pro1.jpg" class="img-fluid rounded shadow-sm mb-3" style="max-height: 500px; object-fit: cover;">
      
      <div id="miniaturas" class="d-flex justify-content-center gap-2 mt-3">
        <img src="img/products/pro1.jpg" class="miniatura rounded" width="70">
      </div>
    </div>

    <!-- Información del producto -->
    <div class="col-md-6">
      <h2 id="producto-nombre" class="mb-3">Jeans Sueltos Negros</h2>
      <h4 id="producto-precio" class="text-success mb-4">$65.00</h4>

      <p><strong>Color:</strong> Negro clásico</p>

      <!-- Tallas -->
      <div class="mb-4">
        <p class="mb-2"><strong>Talla:</strong></p>
        <div id="tallas" class="d-flex gap-2 flex-wrap">
          <button class="btn-talla">S</button>
          <button class="btn-talla">M</button>
          <button class="btn-talla">L</button>
          <button class="btn-talla">XL</button>
          <button class="btn-talla">XXL</button>
        </div>
      </div>

      <!-- Botones -->
      <button class="btn btn-comprar w-100 py-3">Añadir al carrito</button>

      <button id="btnComprarAhora" class="btn btn-primary w-100 mt-3 py-3" data-bs-toggle="modal" data-bs-target="#formCompra">
        Comprar ahora
      </button>

      <p class="mt-4 text-muted small text-center">Envío gratis en pedidos mayores a $75</p>
    </div>

  </div>
</section>

<!-- ===========================================================
     MODAL COMPRA
=========================================================== -->
<div class="modal fade" id="formCompra" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">

      <div class="modal-header">
        <h5 class="modal-title">Finalizar compra</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>

      <div class="modal-body">
        <form id="compraForm">
          <input required placeholder="Nombre completo" class="form-control mb-2" name="nombre">
          <input required type="email" placeholder="Correo" class="form-control mb-2" name="correo">
          <input required placeholder="Dirección" class="form-control mb-2" name="direccion">
          <input required placeholder="Teléfono" class="form-control mb-2" name="telefono">

          <select required class="form-select mb-2" name="pago">
            <option disabled selected value="">Método de pago</option>
            <option>Tarjeta</option>
            <option>Transferencia</option>
            <option>Contra entrega</option>
          </select>
        </form>
      </div>

      <div class="modal-footer">
        <button class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
        <button class="btn btn-success" id="btnFinalizarCompra">Finalizar compra</button>
      </div>

    </div>
  </div>
</div>

<!-- ===========================================================
     SCRIPTS
=========================================================== -->

<!-- jQuery -->
<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<!-- Search Panel Behavior -->
<script>
document.addEventListener("DOMContentLoaded", () => {
  const openBtn  = document.getElementById('open-search');
  const closeBtn = document.getElementById('close-search');
  const panel    = document.getElementById('search-panel');
  const input    = document.getElementById('search-input');

  openBtn?.addEventListener("click", e => {
    e.preventDefault();
    panel.classList.add("show");
    setTimeout(() => input.focus(), 150);
  });

  closeBtn?.addEventListener("click", () => panel.classList.remove("show"));

  document.addEventListener("keydown", e => {
    if (e.key === "Escape") panel.classList.remove("show");
  });
});
</script>

<!-- Añadir al carrito -->
<script>
const params = new URLSearchParams(window.location.search);
const id = params.get("id");

document.querySelector(".btn-comprar").addEventListener("click", () => {

  if (!id) {
    alert("Error: este producto no tiene ID");
    return;
  }

  let cart = JSON.parse(localStorage.getItem("cart")) || [];
  let item = cart.find(p => p.id === id);

  if (item) {
    item.cantidad++;
  } else {
    cart.push({ id, cantidad: 1 });
  }

  localStorage.setItem("cart", JSON.stringify(cart));

  document.getElementById("cart-count").innerText = cart.length;

  alert("✅ Producto agregado");
});
</script>

<!-- Archivos JS globales -->
<script src="script/dom.js"></script>

</body>
</html>
